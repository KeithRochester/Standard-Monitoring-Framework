
# Windows OLEDB Monitor

OLEDB connection/query based monitoring.

Can monitor:

* Connection established
* Query result within range

Can also collect the query result for dashboards/reports.

## Adding Monitoring

To add a Windows OLEDB Monitor...

* Create/update **HKLM:\SOFTWARE\SMF\SCOMDiscoveryData\\##Business Service##\\##Environment##\\WindowsOLEDB** on the agent that will execute the OLEDB connection/query. [Example Registry Key](../Example%20Files/WindowsOLEDB.reg)
* Use the **SMF: Add OLEDB Connection/Query Monitor** task.

## Run As Account

There are two run as account profiles used by OLEDB monitoring. If basic authentication is used a run as account **must** be associated. If Windows authentication is used then the run as account association is only require if the agent default action account does not have the required access. 

* **Standard Monitoring Framework OLEDB Basic Authentication Profile**
* **Standard Monitoring Framework OLEDB Windows Authentication Profile**

## Windows OLEDB Properties 

|Property|Description|
|-|-|
|OLEDB Name|Display Name for the OLEDB Object|
|Connection String|Connection String to be used by the OLEDB probe|
|Query|Query to be executed by the OLEDB probe (Optional)|
|Query Timeout|Timeout in seconds for the query to execute|
|Query Result Minimum Threshold|Minimum value for the value in the monitored row and column of the result set|
|Query Result Maximum Threshold|Maximum value for the value in the monitored row and column of the result set|
|Monitor Query Result|Controls if the value in the monitored row and column of the query result should be monitored|
|Collect Query Result|Controls if the value in the monitored row and column of the query result should be collected for performance reports/dashboards|
|Monitor Row|Which row of the query result should be monitored|
|Monitor Column|Which column of the query result should be monitored|
|Authentication Type|Authentication Type to be used by the OLEDB probe. (Windows or Basic)|

## General Properties

|Property|Description|
|-|-|
|Business Service|The name of the business service that the monitoring is part of|
|Environment|Which lifecycle environment does the business service belong to. E.g. Production, UAT, DEV, etc...|
|Business Service Team|Team that owns the business service|
|Component Name|Name of the logical group that the object belongs to. Used to group similar objects together. E.g. Backend server objects in a Backend Server Component Group|
|Frequency|Frequency in seconds that the monitoring will run|
|Match Count|The number of consecutive samples that must occur before the monitor is unhealthy|
|Schedule Start Time|Time of day that monitoring will run from e.g. 00:00, 08:00, etc...|
|Schedule End Time|Time of day that monitoring will stop running e.g. 23:59, 17:00, etc...|
|Schedule Days|Bit mask for the days of the week that monitoring should run<br>Sunday = 1<br>  Monday = 2 <br>Tuesday = 4<br>Wednesday = 8<br>Thursday = 16<br>Friday = 32<br>Saturday = 64<br><br>Sunday to Saturday = 127<br>Monday to Friday = 62.|
|Description|Description of the object being monitored. This text is included in the alert body|
|Severity|Severity or alerts and state on dashboards. Critical or Warning|
|Priority|Priority that alerts will be assigned. High, Medium, or Low|
|Documentation|Link to documentation. Will be referenced in alerts|
|Object Team|The name of the team that will be responsible for resolving alerts generated by the monitoring|
