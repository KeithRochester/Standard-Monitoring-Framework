# Windows Folder Age Count Monitor

Monitors the number of folders older or younger than the defined age threshold is within the expected range

## Adding Monitoring

To add a Windows Folder Age Count Monitor...

* Create/update **HKLM:\SOFTWARE\SMF\SCOMDiscoveryData\\##Business Service##\\##Environment##\\WindowsFolder** on the agent that will perform the monitoring. [Example Registry Key](../Example%20Files/WindowsFolderAgeCount.reg)
* Use the **SMF: Add Folder Age Count Monitor** task.                 

## Run As Account

If the agents default action account doesn't have the required access to the folders a Windows run as account can be added to the **Standard Monitoring Framework Windows File and Folder Monitoring Profile** run as profile.  

## Windows Folder Age Count Properties 

|Property|Description|
|-|-|
|Display Name|Display name for the folder monitoring|
|Folder Path|Folder Path|
|Sub Folder Pattern|Folder name pattern that folders must match to be included in count. e.g. *, *_temp, etc...|
|Exclude Folder Pattern|Folder name pattern that folders must match to be excluded from count. e.g. *, *_temp, etc...|
|Recursive|Should sub folders be included in the count|
|Hidden Folders|Should hidden (system) folders be included in the count|
|Time Stamp|Which file time stamp should be used when calculating the age of the folders (LastWriteTime, CreationTime, or LastAccessTime) |
|Age Threshold (Minutes)|Age threshold  in minutes to include folders older or newer than|
|Age Threshold Direction|Age threshold direction (Older or Newer)|
|Minimum Number of Folders|A count of folders below the threshold will generate an unhealthy condition|
|Maximum Number of Folders|A count of folders above the threshold will generate an unhealthy condition|

## General Properties

|Property|Description|
|-|-|
|Business Service|The name of the business service that the monitoring is part of|
|Environment|Which lifecycle environment does the business service belong to. E.g. Production, UAT, DEV, etc...|
|Business Service Team|Team that owns the business service|
|Component Name|Name of the logical group that the object belongs to. Used to group similar objects together. E.g. Backend server objects in a Backend Server Component Group|
|Frequency|Frequency in seconds that the monitoring will run|
|Match Count|The number of consecutive samples that must occur before the monitor is unhealthy|
|Schedule Start Time|Time of day that monitoring will run from e.g. 00:00, 08:00, etc...|
|Schedule End Time|Time of day that monitoring will stop running e.g. 23:59, 17:00, etc...|
|Schedule Days|Bit mask for the days of the week that monitoring should run<br>Sunday = 1<br>  Monday = 2 <br>Tuesday = 4<br>Wednesday = 8<br>Thursday = 16<br>Friday = 32<br>Saturday = 64<br><br>Sunday to Saturday = 127<br>Monday to Friday = 62.|
|Description|Description of the object being monitored. This text is included in the alert body|
|Severity|Severity or alerts and state on dashboards. Critical or Warning|
|Priority|Priority that alerts will be assigned. High, Medium, or Low|
|Documentation|Link to documentation. Will be referenced in alerts|
|Object Team|The name of the team that will be responsible for resolving alerts generated by the monitoring|
